# Bot DAATCS - Sistema de GestiÃ³n de Pedidos ğŸ¤–

Bot de WhatsApp optimizado para gestionar pedidos, compatible con **Railway** (nube) y **Termux** (local).

## ğŸŒŸ CaracterÃ­sticas

- âœ… **Dual Environment**: Funciona en Railway y Termux
- âœ… **QR en Terminal**: Para Termux con `qrcode-terminal`
- âœ… **Sistema de Pedidos**: GestiÃ³n completa de Ã³rdenes
- âœ… **Base de Datos JSON**: Sin dependencias externas
- âœ… **Estados Personalizables**: Workflow completo de pedidos
- âœ… **Notificaciones AutomÃ¡ticas**: Al cliente y administradores
- âœ… **Protecciones Anti-Ban**: LÃ­mites y delays inteligentes
- âœ… **Backup AutomÃ¡tico**: Base de datos protegida

## ğŸš€ InstalaciÃ³n RÃ¡pida - Termux

### MÃ©todo AutomÃ¡tico (Recomendado):
```bash
# Descargar e ejecutar instalador
wget -O - https://raw.githubusercontent.com/JR23CR/bot-daatcs-railway/main/install-termux.sh | bash
```

### MÃ©todo Manual:
```bash
# 1. Preparar Termux
termux-setup-storage
apt update && apt upgrade -y
pkg install -y nodejs npm git python chromium

# 2. Clonar repositorio
cd ~
git clone https://github.com/JR23CR/bot-daatcs-railway.git bot-daatcs
cd bot-daatcs

# 3. Instalar dependencias
npm install

# 4. Iniciar bot
npm start
```

## ğŸ“± Uso del Bot

### 1. Obtener cÃ³digo QR:
Al ejecutar `npm start`, el QR aparece **directamente en la terminal** de Termux:

```
==================================================
ğŸ“± CÃ“DIGO QR PARA WHATSAPP BUSINESS
==================================================

â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆâ–ˆâ–ˆâ–ˆ â–„â–„â–„â–„â–„ â–ˆâ–€â–ˆ â–ˆâ–„â–€â–„â–„â–€â–„ â–„â–„â–„â–„â–„ â–ˆâ–ˆâ–ˆâ–ˆ
â–ˆâ–ˆâ–ˆâ–ˆ â–ˆ   â–ˆ â–ˆâ–€â–€â–€â–ˆ â–€ â–€â–ˆâ–€â–€â–ˆ   â–ˆ â–ˆâ–ˆâ–ˆâ–ˆ
â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–„â–„â–„â–ˆ â–ˆâ–€ â–ˆâ–€â–€â–„â–ˆâ–ˆâ–€â–„â–ˆâ–ˆâ–„â–„â–„â–ˆ â–ˆâ–ˆâ–ˆâ–ˆ
[... QR CODE ...]

âœ… QR generado correctamente
ğŸ“² Abre WhatsApp Business > Dispositivos vinculados
==================================================
```

### 2. Escanear con WhatsApp Business:
- Abre **WhatsApp Business** (no WhatsApp normal)
- Ve a **ConfiguraciÃ³n** â†’ **Dispositivos vinculados**
- Toca **"Vincular dispositivo"**
- Escanea el cÃ³digo QR

### 3. Crear grupo:
- Crea un grupo llamado que contenga **"PEDIDOS"** y **"DAATCS"**
- Ejemplo: "PEDIDOS DAATCS", "Grupo Pedidos DAATCS", etc.
- El bot se conectarÃ¡ automÃ¡ticamente

## ğŸ¤– Comandos del Bot

### Para Clientes:
```bash
/nuevo [descripciÃ³n]     # Crear nuevo pedido
/info [ID]              # Ver detalles de pedido
/lista                  # Ver pedidos activos
/ayuda                  # Ver todos los comandos
```

### Para Administradores:
```bash
/estado [ID] [estado]   # Cambiar estado de pedido
/stats                  # Ver estadÃ­sticas completas
/salud                  # Estado del bot
```

### Estados Disponibles:
- `pendiente`, `confirmado`, `proceso`
- `diseÃ±o`, `produccion`, `control`
- `listo`, `entregado`, `cancelado`

## ğŸ’¡ Ejemplos de Uso

```bash
# Cliente crea pedido
/nuevo Camiseta talla M color azul con logo personalizado

# Bot responde con ID
âœ… PEDIDO CREADO EXITOSAMENTE
ğŸ†” ID: #001
ğŸ‘¤ Cliente: Juan PÃ©rez
ğŸ“Š Estado: PENDIENTE

# Admin cambia estado
/estado 001 confirmado

# Cliente consulta estado
/info 001
```

## ğŸ”§ Scripts Ãštiles para Termux

DespuÃ©s de la instalaciÃ³n automÃ¡tica, tendrÃ¡s estos scripts:

```bash
# Iniciar bot normal
./start-bot.sh

# Iniciar con PM2 (24/7)
./start-pm2.sh

# Regenerar QR si hay problemas
./regenerate-qr.sh

# Hacer backup
./backup-data.sh
```

## ğŸ“Š Monitoreo

### URLs disponibles (cuando el bot estÃ© activo):
- **Estado general**: `http://localhost:3000`
- **CÃ³digo QR**: `http://localhost:3000/qr`
- **EstadÃ­sticas**: `http://localhost:3000/stats`

### Comandos PM2:
```bash
pm2 logs daatcs-bot      # Ver logs en tiempo real
pm2 stop daatcs-bot      # Detener bot
pm2 start daatcs-bot     # Iniciar bot
pm2 restart daatcs-bot   # Reiniciar bot
```

## ğŸ› ï¸ SoluciÃ³n de Problemas

### QR no aparece:
```bash
# MÃ©todo 1: Regenerar sesiÃ³n
cd ~/bot-daatcs
./regenerate-qr.sh

# MÃ©todo 2: Limpiar cache
rm -rf auth_data
npm start

# MÃ©todo 3: Reinstalar dependencias
npm install --force
```

### Bot se desconecta:
```bash
# Verificar logs
pm2 logs daatcs-bot

# Reiniciar bot
pm2 restart daatcs-bot

# Si persiste el problema
./regenerate-qr.sh
```

### Error de memoria en Termux:
```bash
# Limpiar cache
npm cache clean --force

# Reiniciar Termux
exit
# Reabrir Termux y ejecutar:
cd ~/bot-daatcs && ./start-bot.sh
```

### Grupo no encontrado:
1. Verifica que el grupo contenga "PEDIDOS" y "DAATCS" en el nombre
2. Usa **WhatsApp Business**, no WhatsApp normal
3. Revisa logs: `pm2 logs daatcs-bot`

## ğŸŒ Despliegue en Railway

### Para Railway, usa el mÃ©todo original:
1. Fork este repositorio
2. Ve a [Railway.app](https://railway.app)
3. Conecta tu GitHub
4. Deploy desde tu fork
5. Railway detectarÃ¡ automÃ¡ticamente la configuraciÃ³n

## ğŸ“ Estructura de Archivos

```
bot-daatcs/
â”œâ”€â”€ bot.js                 # Bot principal (dual environment)
â”œâ”€â”€ package.json           # Dependencias
â”œâ”€â”€ install-termux.sh      # Instalador para Termux
â”œâ”€â”€ start-bot.sh          # Script de inicio
â”œâ”€â”€ start-pm2.sh          # Script PM2
â”œâ”€â”€ regenerate-qr.sh      # Regenerar QR
â”œâ”€â”€ backup-data.sh        # Backup de datos
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ pedidos.json      # Base de datos principal
â”‚   â””â”€â”€ backup-*.json     # Backups automÃ¡ticos
â”œâ”€â”€ auth_data/            # SesiÃ³n de WhatsApp
â””â”€â”€ README.md             # Esta guÃ­a
```

## ğŸ”’ CaracterÃ­sticas de Seguridad

- **LÃ­mites de mensajes**: ProtecciÃ³n anti-ban
- **Horarios de servicio**: 6:00 AM - 10:00 PM
- **Delays inteligentes**: Entre mensajes
- **Backup automÃ¡tico**: Cada 6 horas
- **ValidaciÃ³n de permisos**: Admin vs usuarios
- **Logs detallados**: Para debugging

## ğŸ“ˆ EstadÃ­sticas y Monitoreo

El bot registra automÃ¡ticamente:
- Mensajes procesados
- Comandos ejecutados
- Pedidos por estado
- Errores y rendimiento
- Tiempo de actividad

## ğŸ¤ Contribuir

1. Fork el repositorio
2. Crea una rama para tu feature
3. Commit tus cambios
4. Push a la rama
5. Abre un Pull Request

## ğŸ“„ Licencia

MIT License - Ver archivo LICENSE para mÃ¡s detalles.

## ğŸ“ Soporte

Si tienes problemas:

1. **Revisa los logs**: `pm2 logs daatcs-bot`
2. **Verifica el estado**: `http://localhost:3000`
3. **Regenera QR**: `./regenerate-qr.sh`
4. **Consulta Issues**: [GitHub Issues](https://github.com/JR23CR/bot-daatcs-railway/issues)

---

## âœ… Lista de VerificaciÃ³n

DespuÃ©s de instalar, verifica:

- [ ] âœ… Termux configurado con storage
- [ ] âœ… Node.js y dependencias instaladas
- [ ] âœ… Bot clonado en `~/bot-daatcs`
- [ ] âœ… QR visible en terminal
- [ ] âœ… WhatsApp Business conectado
- [ ] âœ… Grupo creado con nombre correcto
- [ ] âœ… Comandos funcionando (`/ayuda`)
- [ ] âœ… PM2 configurado para 24/7

**Â¡Tu sistema de pedidos DAATCS estÃ¡ listo! ğŸš€**

---

ğŸ­ **DAATCS - Sistema Profesional de GestiÃ³n de Pedidos**
